# destroy galera linodes

- name: destroy galera linodes
  hosts: localhost
  vars_files:
      - group_vars/galera/vars
      - group_vars/galera/secret_vars
  
  vars:
    count: 3
  #  test: false

  tasks:
  - name: deleting galera prod linodes
    linode.cloud.instance:
      #label: '{{ galera_prefix }}{{ 1 + item|int }}'
      label: '{{ galera_prefix }}{{ item }}'
      api_token: '{{ token }}'
      state: absent
    with_sequence: count='{{count}}'
    #when: not test

#  - name: deleting galera test linodes
#    linode.cloud.instance:
#      label: '{{ galera_prefix }}{{ item }}'
#      api_token: '{{ token }}'
#      state: absent
#    with_sequence: count='{{count}}'
#    when: test